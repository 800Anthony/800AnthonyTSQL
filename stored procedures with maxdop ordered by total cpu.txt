select top 5 DBNAME,SCHEMA_NAME,OBJECT_NAME, cached_time, last_execution_time,execution_count,TOTAL_CPU  from 
(
SELECT CASE 
		WHEN DATABASE_ID = 32767
			THEN 'RESOURCE'
		ELSE DB_NAME(DATABASE_ID)
		END AS DBNAME
	,OBJECT_SCHEMA_NAME(OBJECT_ID, DATABASE_ID) AS [SCHEMA_NAME]
	,OBJECT_NAME(OBJECT_ID, DATABASE_ID) AS [OBJECT_NAME]
	,CACHED_TIME
	,LAST_EXECUTION_TIME
	,last_elapsed_time
	,last_logical_reads
	,last_logical_writes
	,last_physical_reads
	,last_spills
	,last_worker_time
	,EXECUTION_COUNT
	,TOTAL_WORKER_TIME / EXECUTION_COUNT AS AVG_CPU
	,TOTAL_WORKER_TIME AS TOTAL_CPU
	,TOTAL_ELAPSED_TIME / EXECUTION_COUNT AS AVG_ELAPSED
	,TOTAL_LOGICAL_READS
	,TOTAL_LOGICAL_READS / EXECUTION_COUNT AS AVG_LOGICAL_READS
	,TOTAL_LOGICAL_WRITES
	,TOTAL_LOGICAL_WRITES / EXECUTION_COUNT AS AVG_LOGICAL_WRITES
	,TOTAL_PHYSICAL_READS
	,TOTAL_PHYSICAL_READS / EXECUTION_COUNT AS AVG_PHYSICAL_READS
FROM SYS.DM_EXEC_PROCEDURE_STATS
where Object_definition(object_id) LIKE '%--%maxdop%' and  Object_definition(object_id) not like '%programarch%'  
)a
order by TOTAL_CPU desc
